# 要件定義

## 1. 目的・ゴール
- 幼児（目安 3〜6 歳）が
  - 直感的な操作でピアノ演奏を体験し
  - カタカナ表記の楽譜を追いながら「知っている曲」を弾けるようになる
  - 遊びながら音感・リズム感を獲得し、達成感を得られる
- 保護者・教育者が
  - 進捗を把握し、次の学習段階へ誘導できる
  - 課金や広告よりも「安心して子どもに渡せる」品質を期待できる

## 2. ターゲットユーザー
- メイン
  - 幼児（3〜6 歳）
- サブ
  - 保護者（楽曲追加・設定変更・課金判断を行う）
  - 幼児教育者（園・教室での利用を想定）

## 3. コア機能（Must）
- 鍵盤表示
  - 1 オクターブ〜2 オクターブの鍵盤（C3〜C5 目安）
  - 各鍵盤にカタカナ音名（ド・レ・ミ …）を常時表示
- カタカナ譜スクロール
  - 楽曲をカラオケのテロップのように左から右へ (←方向へ) 流す
  - 現在位置をハイライト（色・下線）
- 次鍵盤ハイライトモード
  - 再生予定の鍵盤を事前に点滅または点灯
  - 押下するとエフェクト＋次ノートへスムーズ遷移
- ステージ構造
  - Lv.1：単音メロディのみ（時間無制限、正しい鍵盤を押すと次音へ進行）
  - Lv.2：単音メロディのみ（自動テンポ：ゆっくり）
  - Lv.3：単音メロディ（テンポ少し速い、音域拡大）
  - Lv.4：和音や簡単な伴奏パート追加
  - Lv.5：両手演奏（片手ガイド付き）
- 音源再生
  - Tone.js でピアノ音色を生成・再生
  - 遅延 50 ms 以下を目標
- 楽曲ライブラリ
  - 「きらきら星」「かえるの合唱」など著作権フリー＋定番曲をプリインストール
  - JSON で譜面定義：音高・長さ・歌詞（任意）
- 入力方法
  - タッチ（タッチデバイスを前提にする）

## 4. 付加機能（Should）
- スコアリング & バッジ
  - 正しいタイミングで押せた割合を 3 段階でフィードバック
  - Lv. クリア時に「⭐️バッジ」付与
- お手本モード
  - 自動演奏＋鍵盤ライトのみ表示 → 子どもが聞いて覚える
- テンポ可変
  - 0.5×／0.75×／1×／1.25× で練習 → 標準に漸進
- 積み重ねダッシュボード
  - 総演奏回数、曲別クリア率、最近の推し曲トップ 3
- 多言語切替
  - かな音名（あ・い・う …）や英語（C・D・E …）も選択可能

## 5. 将来拡張（Could）
- MIDI キーボード接続（Web MIDI API）

## 6. 非機能要件
- パフォーマンス
  - モバイル端末（iPhone 11 / Android 10 相当）で 60 fps を維持
- レスポンシブデザイン
  - 横向き固定を基本。PC では中央寄せ＋余白演出
- アクセシビリティ
  - カラーブラインド対応配色、音声読み上げ OFF でも操作説明が理解できる UI
- セキュリティ・プライバシー
  - 個人情報の登録不要（匿名 ID）
  - 広告なし／課金時は Stripe Checkout を親モーダルからのみ
- オフライン対応
  - 楽曲・音源を Service Worker でキャッシュ → 機内モードでも利用可
- 国際化
  - i18n フレームワークを導入（曲名・UI 文字列分離）

## 7. 主要画面 UX
- ホーム
  - 曲リスト（アイコン＋星評価）
  - 難易度フィルタ & 検索バー
- プレイ画面
  - 上部：ヘッダー。曲名・設定メニューなど
  - 中央：スクロール譜（ハイライトあり）
  - 下部：鍵盤（押下アニメ＋ライト）
- 結果画面
  - スコアリング（% & バッジ）＋次の推奨レベルへの導線
  - 「もう一度」「ホームへ」の大ボタン

## 8. リスク & 留意点
- 子どもの誤タップ → UI コンポーネント大きめ、誤課金にペアレンタルゲート
