# 開発ガイドライン

本プロジェクトはテスト駆動開発(TDD)を基本とします。実装前にテストを記述し、Red-Green-Refactorサイクルで進めます。依存注入を前提にした設計と、テストの記述方法、さらにAIツール利用時のプロンプト例を以下にまとめます。

## 1. テスト駆動開発(TDD)のルール
- 仕様は `docs/requirements.md` を参照
- 実装を始める前に必ずテストを作成
- 小さな単位でテスト→実装→リファクタリングを繰り返す
- `pnpm run test` でテストを実行し、常に成功させてからコミット
- 例外処理に `try-catch` は使用しない
- コメントを記述しなくても理解できる命名を心掛ける

## 2. 依存注入(Dependency Injection)の設計方針
- 外部依存(状態管理、APIクライアントなど)はコンストラクタや関数引数で受け取る
- テストでは依存をモックに差し替えられるようインターフェースを定義
- React コンポーネントでは Context よりも props 経由の注入を優先
- 副作用を持つ処理は単独のモジュールに分離し、注入できる形で利用

## 3. テストの書き方
- テストファイルは対象コードと同じ階層に `*.test.ts` として配置
- `describe` と `it` ブロックで振る舞いを明確に記述
- 依存はモック/スタブを用いて最小限の単体テストを実施
- 境界値やエラーパスもテストケースに含める
- UI コンポーネントは Testing Library を用いて DOM 操作を検証

## 4. AI ツール利用時のプロンプト例
各AIアシスタントに同じ方針で依頼できるよう、以下の形式を推奨します。

```
あなたはプロジェクト"Myfir Piano"の開発補助AIです。
- docs/requirements.md に沿った機能追加を検討してください。
- 依存注入とTDDを遵守してください。
- try-catchや冗長なコメントは使わず、可読性の高いコード例を提示してください。
```

このテンプレートを基に、目的や詳細を追記して活用してください。
